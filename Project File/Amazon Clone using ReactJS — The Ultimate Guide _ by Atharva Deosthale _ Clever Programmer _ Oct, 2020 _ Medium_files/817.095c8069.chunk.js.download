(self.webpackChunklite=self.webpackChunklite||[]).push([[817],{85714:(e,n,t)=>{"use strict";t.d(n,{ZP:()=>m,v:()=>d,QX:()=>g});var a=t(28655),r=t.n(a),i=t(71439),l=t(67294),o=t(70561),u=t(88914);function s(){var e=r()(["\n  fragment SuspendedBannerLoader_post on Post {\n    id\n    isSuspended\n  }\n"]);return s=function(){return e},e}function c(){var e=r()(["\n  fragment SuspendedBannerLoader_user on User {\n    id\n    isSuspended\n  }\n"]);return c=function(){return e},e}const m=(0,o.$j)()((function(e){var n=e.dispatch,t=e.user,a=e.post;return l.useEffect((function(){t&&t.isSuspended?n((0,u.Dx)({duration:"NEXTPAGE",message:"",toastStyle:"USER_SUSPENDED"})):a&&a.isSuspended&&n((0,u.Dx)({duration:"NEXTPAGE",message:"",toastStyle:"POST_SUSPENDED",extraParams:{postId:(null==a?void 0:a.id)||""}}))}),[]),null}));var d=(0,i.Ps)(c()),g=(0,i.Ps)(s())},82602:(e,n,t)=>{"use strict";t.d(n,{u:()=>te,S:()=>ae});var a,r=t(28655),i=t.n(r),l=t(63038),o=t.n(l),u=t(71439),s=t(67294),c=t.n(s),m=t(42963),d=t(46829),g=t(58875),p=t.n(g),f=t(9785),h=t(79316),E=t(80735),v=t(62630),x=t(28309),b=t(79208),y=t(90038);!function(e){e.Success="success",e.UploadError="uploadError",e.InvalidError="invalidError"}(a||(a={}));var I={height:"132px",width:"132px",display:"flex",flexDirection:"row",justifyContent:"center"},C=function(e){return{backgroundColor:e.baseColor.background.light,borderColor:e.baseColor.border.light,borderRadius:"3px",borderWidth:"1px",alignItems:"center",padding:"25px 20px 25px 20px",marginTop:"",borderStyle:"solid"}},S=function(e){var n=e.setImageId,t=e.initialImageId,r=e.source,i=(0,v.Av)(),l=(0,f.YC)().value,u=(0,x.Iq)(),s=c().useState({imageId:t,imageWidth:0,imageHeight:0}),m=o()(s,2),d=m[0],g=m[1],p=c().useState(null),S=o()(p,2),D=S[0],w=S[1],R=function(e){w(e),i.event("user.updateAvatarResult",{userId:null==l?void 0:l.id,source:r,uploadResult:e})},k=(0,b.JA)((function(e,t,r){var i=t.height,l=t.width,o=e.value.fileId;g({imageId:o,imageHeight:i,imageWidth:l}),i<parseInt("1000px",10)||l<parseInt("1000px",10)?(R(a.InvalidError),U()):(n(o),R(a.Success),r())}),(function(){R(a.UploadError)}),(function(){R(a.InvalidError)})),T=k.inputRef,L=k.fireClick,P=function(){i.event("user.updateAvatarClick",{userId:null==l?void 0:l.id,source:r,hasImage:!!d.imageId}),L()},U=function(){g({imageId:"",imageWidth:0,imageHeight:0}),n("")},F=function(){return c().createElement("div",{className:u([I,C])},c().createElement(h.xu,{alignContent:"center",textAlign:"center"},c().createElement(h.xu,null,"1000 x 1000"),c().createElement(h.xu,null,"pixels")))},A=function(){return c().createElement("div",{className:u([I])},c().createElement("div",{className:u((function(){return{backgroundImage:"url(".concat((0,y.W6)({miroId:d.imageId||"",width:d.imageWidth||0,height:d.imageHeight||0}),")"),backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain",height:"100%",width:"100%",borderRadius:"3px",display:"flex",flexDirection:"row"}}))}))};return c().createElement(h.xu,{display:"flex",flexDirection:"column",maxWidth:"132px"},c().createElement(h.xu,{display:"inline-block",float:"right"},c().createElement((function(){return c().createElement(h.xu,{display:"inline-block",marginBottom:"15px"},d.imageId?c().createElement(A,null):c().createElement(F,null))}),null)),c().createElement((function(){return c().createElement(h.xu,{marginBottom:"10px"},c().createElement("input",{type:"file","aria-hidden":"true",ref:T,className:u({display:"none"})}),c().createElement(h.rU,{inline:!0,linkStyle:"OBVIOUS",onClick:P},"Add photo"))}),null),D===a.UploadError&&c().createElement((function(){return c().createElement(h.xu,{marginTop:"8px"},c().createElement(h.xu,{marginRight:"5px",display:"inline-block"},c().createElement(E.F,{scale:"S",color:"ERROR",tag:"p"},"We couldn't process your request.")),c().createElement(h.xu,{marginRight:"5px",display:"inline-block"},c().createElement(E.F,{scale:"S",tag:"p"},"Try again, or"," ",c().createElement(h.rU,{inline:!0,linkStyle:"OBVIOUS",href:"https://help.medium.com/hc/en-us"},"search our help center for support."))))}),null),D===a.InvalidError&&c().createElement((function(){return c().createElement(h.xu,{marginRight:"5px",display:"inline-block"},c().createElement(E.F,{scale:"S",color:"ERROR",tag:"p"},"That file doesn't meet our requirements. Try another."))}),null))},D=function(e){var n=e.label,t=e.onChangeFn,a=e.onBlurFn,r=e.value,i=e.errorMessage,l=e.characterCountLimit;return c().createElement(c().Fragment,null,c().createElement(h.xu,{marginBottom:"15px",textAlign:"left"},c().createElement(E.F,{scale:"L"},n)),c().createElement(h.nv,{scale:"L",onChange:t,value:r,errorMessage:i,onBlur:a,ariaLabel:n,characterCountLimit:l}))},w=t(22091),R=t(29035);function k(){var e=i()(["\n  mutation userCompleteProfileMutation(\n    $userId: ID!\n    $name: String!\n    $bio: String!\n    $imageId: String!\n  ) {\n    userCompleteProfile(userId: $userId, name: $name, bio: $bio, imageId: $imageId)\n  }\n"]);return k=function(){return e},e}function T(){var e=i()(["\n  fragment UserCompleteProfileDialog_user on User {\n    id\n    name\n    bio\n    imageId\n    hasCompletedProfile\n  }\n"]);return T=function(){return e},e}var L={min:3,max:50,message:"Please try another name that’s between 3 and 50 characters."},P={min:10,max:160,message:"Please try another description that’s between 10 and 160 characters."},U=function(e,n){var t=e.min,a=e.max,r=e.message;return function(e){var i=e.target.value;n(i.length<t||i.length>a?r:void 0)}},F=function(e){var n=(0,f.YC)().value;return{shouldShowDialog:p().canUseDOM&&!(0,R.ic)(navigator.userAgent)&&(null==n?void 0:n.id)===e.id}},A=function(e){var n=e.setHasCompletedProfile,t=e.user,a=(0,v.Av)(),r=(0,f.YC)().value,i=s.useState(!1),l=o()(i,2),u=l[0],c=l[1],m=H(),d=o()(m,1)[0],g=s.useState((null==t?void 0:t.imageId)||""),p=o()(g,2),h=p[0],x=p[1],b=s.useState((null==t?void 0:t.name)||""),y=o()(b,2),I=y[0],C=y[1],R=s.useState((null==t?void 0:t.bio)||""),k=o()(R,2),T=k[0],A=k[1],B=s.useState(),M=o()(B,2),N=M[0],O=M[1],_=s.useState(),V=o()(_,2),$=V[0],G=V[1],W=U(L,O),Q=U(P,G),Y=s.useCallback((function(){r&&(c(!0),a.event("user.completedProfile",{userId:r.id,changedName:(null==t?void 0:t.name)!==I,changedBio:(null==t?void 0:t.bio)!==T,changedImage:(null==t?void 0:t.imageId)!==h,hasName:!!I,hasBio:!!T,hasImage:!!h}),d({variables:{userId:r.id,name:I,bio:T,imageId:h}}).then((function(){c(!1),n(!0)})))}),[r,d,c,t,I,T,h]),q=F(t).shouldShowDialog;return s.useEffect((function(){q&&a.event("user.presentedCompleteProfileDialog",{userId:null==r?void 0:r.id})}),[q]),q?s.createElement(s.Fragment,null,s.createElement(w.QH,{contentTag:"p",confirmText:"Continue",titleText:"Complete your profile",isDestructiveAction:!1,onConfirm:Y,isVisible:!0,hide:function(){},withCloseButton:!1,showCancelButton:!1,disableConfirm:u},s.createElement(E.F,{scale:"L",color:"DARKER"},"Readers like learning a bit more about their writers"),s.createElement(w.xu,{marginTop:"48px",marginBottom:"28px",display:"flex",flexDirection:"row"},s.createElement(w.xu,{overflow:"visible",maxHeight:"200px"},s.createElement(S,{setImageId:x,initialImageId:h,source:"userCompleteProfileDialog"})),s.createElement(w.xu,{marginLeft:"48px",textAlign:"left"},s.createElement(w.xu,{key:"name"},s.createElement(D,{label:"Full name",onChangeFn:function(e){return C(e.target.value)},onBlurFn:W,value:I,errorMessage:N})),s.createElement(w.xu,{key:"bio",marginTop:"40px"},s.createElement(D,{label:"Bio (optional, max 160 characters)",onChangeFn:function(e){return A(e.target.value)},onBlurFn:Q,value:T,errorMessage:$,characterCountLimit:160})))))):null},B=(0,u.Ps)(T()),H=function(){return(0,d.useMutation)(M)},M=(0,u.Ps)(k()),N=t(23279),O=t.n(N),_=t(70561),V=t(51064),$=t(27952);function G(){var e=i()(["\n  query userDomainValidityQuery($domain: String!) {\n    userDomainValidity(domain: $domain)\n  }\n"]);return G=function(){return e},e}function W(){var e=i()(["\n  mutation createUserDomainMutation($domain: String!) {\n    userDomainLink(domain: $domain) {\n      __typename\n      ... on CustomDomainFailure {\n        reason\n      }\n    }\n  }\n"]);return W=function(){return e},e}function Q(){var e=i()(["\n  fragment UserDomainOnboardingDialog_user on User {\n    id\n    hasDomain\n    username\n  }\n"]);return Q=function(){return e},e}var Y=function(e){var n=e.user,t=e.isVisible,a=e.hide,r=e.redirectTo,i=e.redirectOnHide,l=void 0!==i&&i,u=e.refreshOnHide,c=void 0!==u&&u,m=(0,x.Iq)(),d=(0,v.Av)(),g=(0,f.YC)().value,h=(null==g?void 0:g.username)?function(e){return e.toLowerCase().replace(/[_.]/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-/,"").replace(/-$/,"")}(g.username):"",b=s.useState(h),y=o()(b,2),I=y[0],C=y[1],S=(0,V.O)(!1),D=o()(S,3),R=D[0],k=D[1],T=D[2],L=s.useState(!1),P=o()(L,2),U=P[0],F=P[1],A=s.useState(!1),B=o()(A,2),H=B[0],M=B[1],N=Z(I),G=J(I),W=s.useState(null),Q=o()(W,2),Y=Q[0],q=Q[1],X=(0,_.v9)((function(e){return e.config})).productName,K=z(),ee=o()(K,1)[0],ne=j(N),te=ne.isValidityLoading,ae=ne.validityResult,re=ne.checkValidity,ie=s.useCallback(O()((function(e){re(e),F(!1)}),500),[]),le=s.useCallback((function(e){var n=e.target.value;U||F(!0),q(null),ie({domain:n}),C(n)}),[re,U]),oe=s.useCallback((function(){M(!0),d.event("user.claimedSubdomain",{userId:null==g?void 0:g.id,source:"subdomain_dialog",changedUsername:(null==g?void 0:g.username)!==I}),ee({variables:{domain:N}}).then((function(e){var n,t,r,i;if("CustomDomain"===(null===(n=e.data)||void 0===n||null===(t=n.userDomainLink)||void 0===t?void 0:t.__typename))k(),a();else if("CustomDomainFailure"===(null===(r=e.data)||void 0===r||null===(i=r.userDomainLink)||void 0===i?void 0:i.__typename))switch(e.data.userDomainLink.reason){case"AlreadyInUse":q("This name is already in use.");break;case"Length":q("The name must be between 3 and 63 characters long.");break;case"Characters":q("The name can only include lowercase letters, numbers and hyphens.");break;case"StartEnd":q("The name cannot begin or end in a hyphen");break;case"Internal":q("There was a server error, please try again.");break;case"Invalid":q("This name is invalid. Try another one.");break;default:q("Something went wrong. Please try again with a different name.")}else q("Something went wrong. Please try again with a different name.");M(!1)}))}),[ee,d,g,N,I]),ue=s.useCallback((function(){l&&r(G),T(),c&&window.location.reload()}),[G,l,c]),se=!!g&&n.id===g.id&&!n.hasDomain&&p().canUseDOM;if(s.useEffect((function(){t&&se&&d.event("user.presentedClaimSubdomainDialog",{userId:null==g?void 0:g.id})}),[t,se]),!se)return null;var ce=!U&&!te&&(null==ae?void 0:ae.userDomainValidity);return s.createElement(s.Fragment,null,s.createElement(w.QH,{confirmText:"Claim URL",titleText:"Claim your ".concat(X," URL"),isDestructiveAction:!1,onConfirm:oe,isVisible:t,hide:a,withCloseButton:!1,showCancelButton:!1,secondaryButton:s.createElement(w.zx,{href:(0,$.mc)(),size:"REGULAR"},"Learn More"),hideOnConfirm:!1,disableConfirm:H||!!Y||!ce},"All your stories show up on your profile, and it now comes with a personalized URL. The name you pick below will also be your username on ",X,".",s.createElement(w.xu,{marginBottom:"14px",marginTop:"32px",display:"flex",flexDirection:"column"},s.createElement(w.nv,{ariaLabel:"Profile domain",onChange:le,value:I,errorMessage:null!=Y?Y:void 0,hideErrorIcon:!0}),!Y&&s.createElement(w.xu,{display:"inline-block",marginTop:"8px"},s.createElement("table",{className:m({display:"table",marginLeft:"auto",marginRight:"auto",textAlign:"left",borderSpacing:"4px",tableLayout:"fixed",maxWidth:"100%"})},s.createElement("tbody",null,s.createElement("tr",null,s.createElement("td",{className:m({paddingRight:"4px",verticalAlign:"top"})},s.createElement(E.F,{color:"LIGHTER",scale:"M"},s.createElement("strong",null,"URL"))),s.createElement("td",null,s.createElement(E.F,{color:"LIGHTER",scale:"M"},N))),s.createElement("tr",null,s.createElement("td",{className:m({paddingRight:"4px",verticalAlign:"top"})},s.createElement(E.F,{color:"LIGHTER",scale:"M"},s.createElement("strong",null,"Username"))),s.createElement("td",{className:m({marginBottom:"12px",marginTop:"10px"})},s.createElement(E.F,{color:"LIGHTER",scale:"M"},"@",I))),s.createElement("tr",null,s.createElement("td",null),s.createElement("td",{className:m({visibility:I===n.username?"hidden":"visible"})},s.createElement(E.F,{color:"LIGHTER",scale:"M"},"@",n.username," will no longer be valid")))))))),s.createElement(w.QH,{confirmText:"Done",titleText:"You're all set.",isDestructiveAction:!1,onConfirm:function(){},isVisible:R,hide:ue,withCloseButton:!1,showCancelButton:!1},"Your profile is now available at your ",X," URL.",s.createElement(w.xu,null,s.createElement(w.xu,{display:"inline-block",marginTop:"28px"},s.createElement("table",{className:m({display:"table",marginLeft:"auto",marginRight:"auto",textAlign:"left",tableLayout:"fixed",maxWidth:"100%"})},s.createElement("tbody",null,s.createElement("tr",null,s.createElement("td",{className:m({marginBottom:"12px",paddingRight:"8px",verticalAlign:"top"})},s.createElement(E.F,{color:"LIGHTER",scale:"M"},s.createElement("strong",null,"URL"))),s.createElement("td",null,s.createElement(E.F,{color:"LIGHTER",scale:"M"},N))),s.createElement("tr",{className:m({paddingTop:"8px"})},s.createElement("td",{className:m({paddingRight:"8px",verticalAlign:"top"})},s.createElement(E.F,{color:"LIGHTER",scale:"M"},s.createElement("strong",null,"Username"))),s.createElement("td",{className:m({marginBottom:"12px"})},s.createElement(E.F,{color:"LIGHTER",scale:"M"},"@",I)))))))))},q=(0,u.Ps)(Q()),z=function(){return(0,d.useMutation)(X)},X=(0,u.Ps)(W()),j=function(e){var n=(0,d.useQuery)(K,{variables:{domain:e}});return{isValidityLoading:n.loading,validityResult:n.data,checkValidity:n.refetch}},K=(0,u.Ps)(G()),Z=function(e){var n=(0,_.v9)((function(e){return e.config.authDomain})).split(":")[0];return"".concat(e,".").concat(n)},J=function(e){var n=(0,_.v9)((function(e){return e.config.authDomain}));return"https://".concat(e,".").concat(n)},ee=t(77455);function ne(){var e=i()(["\n  fragment UserDomainFlow_user on User {\n    id\n    hasCompletedProfile\n    name\n    bio\n    imageId\n    ...UserCompleteProfileDialog_user\n    ...UserDomainOnboardingDialog_user\n  }\n  ","\n  ","\n"]);return ne=function(){return e},e}var te=function(e){var n=e.user,t=e.redirectOnComplete,a=void 0!==t&&t,r=e.refreshOnComplete,i=void 0!==r&&r,l="true"===(0,ee.K)().get("showDomainSetup"),u=(0,V.O)(l),c=o()(u,3),d=c[0],g=c[2],p=s.useState(n.hasCompletedProfile),f=o()(p,2),h=f[0],E=f[1],v=s.useState(null),x=o()(v,2),b=x[0],y=x[1],I=F(n).shouldShowDialog&&!h&&(!n.name||!n.bio||!n.imageId);return b?s.createElement(m.Z,{to:b,replace:!0}):s.createElement(s.Fragment,null,s.createElement(Y,{isVisible:d&&!I,hide:g,user:n,redirectTo:y,redirectOnHide:a,refreshOnHide:i}),d&&I?s.createElement(A,{user:n,setHasCompletedProfile:E}):null)},ae=(0,u.Ps)(ne(),B,q)}}]);
//# sourceMappingURL=817.095c8069.chunk.js.map